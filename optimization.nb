(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[      8950,        241]
NotebookOptionsPosition[      7635,        215]
NotebookOutlinePosition[      8028,        231]
CellTagsIndexPosition[      7985,        228]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wu", "[", 
   RowBox[{"n_", ",", "r_", ",", "c_"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"c", "+", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v", "/", "r"}], ")"}], "*", "n", "*", 
        RowBox[{"(", 
         RowBox[{"T", "/", "Nslots"}], ")"}]}], "]"}]}]}], ",", "H", ",", 
    RowBox[{"r", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "/", "r"}], ")"}], "*", "n", "*", 
       RowBox[{"(", 
        RowBox[{"T", "/", "Nslots"}], ")"}]}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgu", "[", 
   RowBox[{"n_", ",", "r_", ",", "c_", ",", "x_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{"wu", "[", 
     RowBox[{"n", ",", "r", ",", "c"}], "]"}], "-", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "z"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dub", "[", 
    RowBox[{"n_", ",", "r_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"Norm", "[", 
    RowBox[{"wu", "[", 
     RowBox[{"n", ",", "r", ",", "c"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pru", "[", 
   RowBox[{"n_", ",", "r_", ",", "c_", ",", "x_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"ptg", "*", "gt", "*", "gr", "*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"lambda", "/", 
      RowBox[{"(", 
       RowBox[{"4", "*", "Pi", "*", 
        RowBox[{"dgu", "[", 
         RowBox[{"n", ",", "r", ",", "c", ",", "x", ",", "z"}], "]"}]}], 
       ")"}]}], ")"}], "^", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prb", "[", 
    RowBox[{"n_", ",", "r_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"ptu", "*", "gt", "*", "gr", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lambda", "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", "Pi", "*", 
         RowBox[{"dub", "[", 
          RowBox[{"n", ",", "r", ",", "c"}], "]"}]}], ")"}]}], ")"}], "^", 
     "2"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"segu", "[", 
   RowBox[{"n_", ",", "r_", ",", "c_", ",", "x_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Log2", "[", 
   RowBox[{"1", " ", "+", " ", 
    RowBox[{
     RowBox[{"pru", "[", 
      RowBox[{"n", ",", "r", ",", "c", ",", "x", ",", "z"}], "]"}], "/", 
     "Ng"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"seub", "[", 
    RowBox[{"n_", ",", "r_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"Log2", "[", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"prb", "[", 
       RowBox[{"n", ",", "r", ",", "c"}], "]"}], "/", "Nb"}]}], "]"}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expse", "[", 
   RowBox[{"a_", ",", "r_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", "Nslots"}], ")"}], "*", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"a", "*", "M", "*", 
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"L", "^", "2"}]}], ")"}], "*", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"segu", "[", 
             RowBox[{"n", ",", "r", ",", "c", ",", "x", ",", "z"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "L"}], "}"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "a"}], ")"}], "*", 
        RowBox[{"seub", "[", 
         RowBox[{"n", ",", "r", ",", "c"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"Nslots", "-", "1"}]}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.962370052236318*^9, 3.962370072331944*^9}, {
  3.962370112903364*^9, 3.9623701350073442`*^9}, {3.9623701843902397`*^9, 
  3.962370287528762*^9}, {3.96237031868636*^9, 3.962370344566374*^9}, {
  3.9623704079663877`*^9, 3.962370424952157*^9}, {3.9623705221763487`*^9, 
  3.962370538947193*^9}, {3.962370620028145*^9, 3.9623706857679377`*^9}, {
  3.962370749606215*^9, 3.9623707586936207`*^9}, {3.9623707899685*^9, 
  3.9623708115486813`*^9}, {3.962370867413371*^9, 3.9623709163656607`*^9}, {
  3.962371029012583*^9, 3.962371035592404*^9}, {3.962371162862747*^9, 
  3.962371593280861*^9}, {3.962371659116748*^9, 3.962371668078545*^9}, {
  3.96237530409153*^9, 3.962375551810915*^9}, {3.9623755838943977`*^9, 
  3.962375735167478*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"8f2db5c5-8fcd-4d8e-9c3e-94e84e343ab9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"expse", ",", 
     RowBox[{"r", ">", "50"}]}], "}"}], ",", "r"}], "]"}]], "Input",
 CellChangeTimes->{{3.9623757879814262`*^9, 3.962375792277707*^9}, {
  3.962375844300584*^9, 3.962375853612503*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"05a55fc4-9a41-47e7-aa8c-9f0d50ad157e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"expse", ",", 
   RowBox[{"{", 
    RowBox[{"r", "\[Rule]", "77"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9623757964042807`*^9, 3.96237585534517*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"9d3e8250-7ca6-42ce-bd84-724991db8e33"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.962370696732875*^9, 3.9623707032570343`*^9}, 
   3.962370804403305*^9},ExpressionUUID->"53d7debf-7f77-4716-8e0c-\
ec40f1270d70"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.962371025948619*^9, 3.962371027029965*^9}, {
   3.962371211782906*^9, 3.962371213251553*^9}, 3.962371277403275*^9, {
   3.962371373234399*^9, 3.962371374733098*^9}, 
   3.962371457812748*^9},ExpressionUUID->"bb7927cd-2b85-4eea-b1d4-\
d03362516d33"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.96237145469419*^9, 
  3.962371454695663*^9}},ExpressionUUID->"f7d3f367-26ed-499e-9c8b-\
dd6d6ba5e34d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9623712810283003`*^9, 
  3.962371282092289*^9}},ExpressionUUID->"ae549707-03dc-4376-87b2-\
03a4900a5062"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.962370807071932*^9, 3.962370807074172*^9}, {
   3.9623708416878557`*^9, 3.9623708474717293`*^9}, {3.962370900988482*^9, 
   3.9623709055550203`*^9}, {3.962370986423818*^9, 3.962370988815782*^9}, 
   3.962371023915675*^9},ExpressionUUID->"af6437b7-30eb-4bd0-9b60-\
e7d46f80392e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.962370993964171*^9, 
  3.962371021501834*^9}},ExpressionUUID->"157349d9-2202-4f66-aae1-\
8b07c4a8415d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.96237101580575*^9, 
  3.9623710158081408`*^9}},ExpressionUUID->"7de92cb9-76e1-458c-a735-\
ba169a3c7206"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.962371011617866*^9, 
  3.962371011619913*^9}},ExpressionUUID->"7effa59a-4132-4e5f-87ce-\
84ed015c3b74"]
},
WindowSize->{1512, 829},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"13f6831c-30ef-4db6-940a-ca05d9e56139"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 4813, 128, 274, "Input",ExpressionUUID->"8f2db5c5-8fcd-4d8e-9c3e-94e84e343ab9"],
Cell[CellGroupData[{
Cell[5392, 152, 360, 8, 29, "Input",ExpressionUUID->"05a55fc4-9a41-47e7-aa8c-9f0d50ad157e"],
Cell[5755, 162, 277, 6, 33, "Output",ExpressionUUID->"9d3e8250-7ca6-42ce-bd84-724991db8e33"]
}, Open  ]],
Cell[6047, 171, 177, 3, 29, "Input",ExpressionUUID->"53d7debf-7f77-4716-8e0c-ec40f1270d70"],
Cell[6227, 176, 297, 5, 29, "Input",ExpressionUUID->"bb7927cd-2b85-4eea-b1d4-d03362516d33"],
Cell[6527, 183, 151, 3, 29, "Input",ExpressionUUID->"f7d3f367-26ed-499e-9c8b-dd6d6ba5e34d"],
Cell[6681, 188, 154, 3, 29, "Input",ExpressionUUID->"ae549707-03dc-4376-87b2-03a4900a5062"],
Cell[6838, 193, 327, 5, 29, "Input",ExpressionUUID->"af6437b7-30eb-4bd0-9b60-e7d46f80392e"],
Cell[7168, 200, 152, 3, 29, "Input",ExpressionUUID->"157349d9-2202-4f66-aae1-8b07c4a8415d"],
Cell[7323, 205, 153, 3, 29, "Input",ExpressionUUID->"7de92cb9-76e1-458c-a735-ba169a3c7206"],
Cell[7479, 210, 152, 3, 29, "Input",ExpressionUUID->"7effa59a-4132-4e5f-87ce-84ed015c3b74"]
}
]
*)

